import crypto from "crypto";

// const o = {
//   SAMLResponse:
//     "fZHNasMwEIRfxeie6Mdx4ojEUJpLIL00IYdewtra1gZZMt516ePXTluaQgnoImm+mWF3Q9D6zh7iWxz4GamLgTD5aH0ge/3aiqEPNgI1ZAO0SJYre3x4OlgzV7brI8cqenGD3CeACHtuYhDJfrcVl6VS68Va5ZlbA5bG5SkqnSKkRhuzMtUKl/miVIivIjljTyO5FaPRiBMNuA/EEHh8UjqfqcVM65PObGrG8yKSHRI3AfhK1cydlbJx3dy/1/MWbaaUkjBwLafiEpgk9wiOOAachBfycUwKP5M5xbHyau1KjStw2lSg3TLFrBTFZrKw11J98R3lYwW+jsTWqClqkpjJV7bI4IBh3tXdRt6im6+NHBl4oL+3x+gwOYMf8P6M6aq2x6GqkEjI4ivh11T+t/XiEw==",
//   SigAlg: "http://www.w3.org/2000/09/xmldsig#rsa-sha1",
//   Signature:
//     "RRcmtS0Qku3Y5HfSQYKax07dZOnb+CvvtP72v6ws/kttG4DYaNkRy0YmgDjrSLiVNooJe69LMb3pnHsW2PN7pKKe1p/TroGfk/7BW/QRgl3jvnLeM19qvhb3WYgwmeEXWvuX2rhopGCF2bVuzz9UDPZEDTQ6Botq39QkNTYfn1EpTlGHGQ7k/f9l2rX8DoVOu+v9Ov+PIUd0wSYiT1Nw/Nv2/xoMP+jDQCfU/x+D01wcInwlceaIKkYNb/VX3e9E3GzhOljJiUEVA7t9CEDMOACgfhiof9m/70txwhxGWPzE0XrBIIpuGp8NPU9QaiVDymbd9wzDVtll6abpx2t14A==",
//   originalQuery:
//     "SAMLResponse=fZHNasMwEIRfxeie6Mdx4ojEUJpLIL00IYdewtra1gZZMt516ePXTluaQgnoImm%2BmWF3Q9D6zh7iWxz4GamLgTD5aH0ge%2F3aiqEPNgI1ZAO0SJYre3x4OlgzV7brI8cqenGD3CeACHtuYhDJfrcVl6VS68Va5ZlbA5bG5SkqnSKkRhuzMtUKl%2FmiVIivIjljTyO5FaPRiBMNuA%2FEEHh8UjqfqcVM65PObGrG8yKSHRI3AfhK1cydlbJx3dy%2F1%2FMWbaaUkjBwLafiEpgk9wiOOAachBfycUwKP5M5xbHyau1KjStw2lSg3TLFrBTFZrKw11J98R3lYwW%2BjsTWqClqkpjJV7bI4IBh3tXdRt6im6%2BNHBl4oL%2B3x%2BgwOYMf8P6M6aq2x6GqkEjI4ivh11T%2Bt%2FXiEw%3D%3D&SigAlg=http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23rsa-sha1&Signature=RRcmtS0Qku3Y5HfSQYKax07dZOnb%2BCvvtP72v6ws%2FkttG4DYaNkRy0YmgDjrSLiVNooJe69LMb3pnHsW2PN7pKKe1p%2FTroGfk%2F7BW%2FQRgl3jvnLeM19qvhb3WYgwmeEXWvuX2rhopGCF2bVuzz9UDPZEDTQ6Botq39QkNTYfn1EpTlGHGQ7k%2Ff9l2rX8DoVOu%2Bv9Ov%2BPIUd0wSYiT1Nw%2FNv2%2FxoMP%2BjDQCfU%2Fx%2BD01wcInwlceaIKkYNb%2FVX3e9E3GzhOljJiUEVA7t9CEDMOACgfhiof9m%2F70txwhxGWPzE0XrBIIpuGp8NPU9QaiVDymbd9wzDVtll6abpx2t14A%3D%3D",
// };

const pemFile1 =
  "-----BEGIN CERTIFICATE-----\nMIIDXjCCAkagAwIBAgIKFsJi7wAAAAAEdjANBgkqhkiG9w0BAQsFADAaMRgwFgYDVQQDEw9jYS5zbG92ZW5za28uc2swHhcNMjMwMTI0MTI0ODMwWhcNMjYwMTI0MTI1ODMwWjAqMQswCQYDVQQGEwJTSzEbMBkGA1UEAxMSaWRwLnVwdnNmaXguZ292LnNrMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp4z3fUar52k1U1y5OFFpPWFYolv76Yk2leBrgiwwg6SholhWTR3hztNMYEqnZKUOMNVg6GAbnEGvevsdsf/xZKZo3npaphkKF1OMzmrEuT8YB5J0+c7FGILPgNd5Pcg0VN2wbwyTJ9vukYAIxp7Nugx5DRAS9kj6jLNT/WFi6Pa9VdAp4fW09Rg8wtfp+ThDjAJs3PPXcZhVY7etLJF7yztsn6eJeO1MEwCcjdJ3KAPqEDGAbtI3xuR7R3hiPX0FN/ILTk9DoUHV5Aj7DTNquUKbh2sxro3K+RemRJ0Zsfxs+OMbAPfWWGOUxONbCsNpj2GYPTI3gMCo+hiUXp8tnQIDAQABo4GVMIGSMA4GA1UdDwEB/wQEAwIE8DATBgNVHSUEDDAKBggrBgEFBQcDAjAdBgNVHQ4EFgQUpB8qqDoECbwcbnAtlEQAP3ipG98wHwYDVR0jBBgwFoAUKlO3Thprk0Xf6VQr2tu4TpoSzoYwDAYDVR0TAQH/BAIwADAdBgNVHREEFjAUghJpZHAudXB2c2ZpeC5nb3Yuc2swDQYJKoZIhvcNAQELBQADggEBAKOL2PbGO8M3+kFKCQM8vfLNIdFCQw6OBnRftLxs8Xrd310BhhoKWYY6wk4U6xRF3GN/6OGY378rPyxedeJS2nHjIopRIwcHg8x4F09XRUFT24KrCXm/T17hiWcnGt7VIrof6VJHwoyes7D4++qzoFl1jHptjx7RCaF5pwLyFzs/dgIozj+KaRra2dllYPkdFKKNZk0EJteK5bT4rsr+KYUILxBd8FjAl3K0QjT7W/vII2A2szm+d9STyvq1/MthuqKy4kkesekUN8lWBhnRtax37nFmRqFGXNj6ZWoTW+XK00ajwE+7EP7vjepKwby/xWtV8aeqjj2K07hNtSA5OFA=\n-----END CERTIFICATE-----";

// https://localhost.dev:3001/upvs/logout?SAMLRequest=nVJbb9MwFP4rkd9zc5xLrbbTRIUIKhtb127rC3Kbk9TFsVPbCRW%2FHiUZokwwIV6P%2FV3PmV6da%2BF0oA1XcoZCL0BX86lhtWjoUlWqtfdwasFY51wLaejwMkOtllQxww2VrAZD7Z6urj8tKfYC2mhl1V4JdAF5G8GMAW25ksjJFzP0BZOUhcGOsDTaJWUEOxKnkIQsi6NoMiEZLkMgSVkgZ%2FPTOPYC5OTGtJBLY5m0M4QDTNwwdHH4gAMaxxQTLyXJFjkLMJZLZgfkwdrGUN8Xas%2FEQRnrFdDRKAhCv20644uhBTSWQgcJ%2FR%2FJ5n%2FUwVP%2FgvZF44bVkC%2Bc90rXzL7N30944ZbDV2o1k4aDtMjpOe5aJnjJQf8K2Wh%2BEMyA5OD16Up%2B9irVeearr1jtl1AgZ%2FX5L%2BDfnaM5L9zNqUu3m8d0fQtLl6yDm6fTJMNy%2FaE8PqauiDGZ6Osdj15ijsnGmLihKzD99nJZwPmiUvyvB9Y7SMKyap9PUfPtiRWxlbdWrrPjvnqW7wAWd1UmPkbHrft9dPBKdD5OX536%2FAc%3D&SigAlg=http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmldsig-more%23rsa-sha256&Signature=MPVM3OhAUng2ikPN3TYnzHiUMafSfqQ8khABmR1p5UrpeBvgwszq2%2BFYAf%2FUYYMZ5Z5%2FuYE5p0h4QdV3oAWrXhhCBxM2VprrQq0qYGubM1Cgk%2BD1ppK4q2MvKxadyt%2FJYRfGQcwlpq11a%2F9RBDzggNcHalc5%2BWCFlNC0ZYMgR2iWzfXl9cdg%2FhR%2F%2BjHCxCZIH58ov5QwgCuuNrbeuMq5RLujvU4qanKSzXE0PMt6AK0lMb%2FSSJK45Zqc1jfjIMVTVroYrixzUPzb%2FRw6d1T7m3Z1pfKoCODOQhgzuFFZylTP1bZc4hZpk%2FpB6PFQ7PEijnBaps%2FwM4898Jlz9pSLmQ%3D%3D
function validate(pemFile: string) {
  const signature =
    "MPVM3OhAUng2ikPN3TYnzHiUMafSfqQ8khABmR1p5UrpeBvgwszq2+FYAf/UYYMZ5Z5/uYE5p0h4QdV3oAWrXhhCBxM2VprrQq0qYGubM1Cgk+D1ppK4q2MvKxadyt/JYRfGQcwlpq11a/9RBDzggNcHalc5+WCFlNC0ZYMgR2iWzfXl9cdg/hR/+jHCxCZIH58ov5QwgCuuNrbeuMq5RLujvU4qanKSzXE0PMt6AK0lMb/SSJK45Zqc1jfjIMVTVroYrixzUPzb/Rw6d1T7m3Z1pfKoCODOQhgzuFFZylTP1bZc4hZpk/pB6PFQ7PEijnBaps/wM4898Jlz9pSLmQ==";
  // "hEokd5mHl5ufkBj+bHsJCv9d+o53l80zdRnLvKy11ZzUKK74RiqjuGhJin8o+HRaTs8yqIJHnYg/K1D+MOJYQZbEnnC0UvCHB572TlN+u1z1qck90zel0nwJY9rwtxNwc6V/2J5gVUawlUlg9e8WbBc0GI9mG+K901s9Z5DYVdz4CeF3C/y34DpLN43SOeykerqOaYbAIHqbdaq+fPkNtccdUdnEEAuHgk5M3RT5hGrNWS6A3ancjyMrbXDdgeis/TjU2nskA79tJSx0S9DVlh/nUeIrlCcxrzQkY43eYLPK3cmVVprKN9SoirzevNIyrDJ8Y9M4lOtkI/bxwVzkcA==";
  const urlString = Buffer.from(
    "nVJbb9MwFP4rkd9zc5xLrbbTRIUIKhtb127rC3Kbk9TFsVPbCRW/HiUZokwwIV6P/V3PmV6da+F0oA1XcoZCL0BX86lhtWjoUlWqtfdwasFY51wLaejwMkOtllQxww2VrAZD7Z6urj8tKfYC2mhl1V4JdAF5G8GMAW25ksjJFzP0BZOUhcGOsDTaJWUEOxKnkIQsi6NoMiEZLkMgSVkgZ/PTOPYC5OTGtJBLY5m0M4QDTNwwdHH4gAMaxxQTLyXJFjkLMJZLZgfkwdrGUN8Xas/EQRnrFdDRKAhCv20644uhBTSWQgcJ/R/J5n/UwVP/gvZF44bVkC+c90rXzL7N30944ZbDV2o1k4aDtMjpOe5aJnjJQf8K2Wh+EMyA5OD16Up+9irVeearr1jtl1AgZ/X5L+DfnaM5L9zNqUu3m8d0fQtLl6yDm6fTJMNy/aE8PqauiDGZ6Osdj15ijsnGmLihKzD99nJZwPmiUvyvB9Y7SMKyap9PUfPtiRWxlbdWrrPjvnqW7wAWd1UmPkbHrft9dPBKdD5OX536/Ac=",
    "base64"
  ).toString();
  // "SAMLRequest=nVJbb5swFP4ryO9cbCBQK6GqFk1jytp1WdI2L5MDhjgzNvExLNqvn4BOy6qtmvZ67O96zvz63Ein5waEVguEvQBdZ3NgjWzpSte6s5%2F4qeNgnXMjFdDxZYE6o6hmIIAq1nCgtqDrmw8rSryAtkZbXWiJLiCvIxgAN1ZohZx8uUBfyL7aV7Ow2uMIx6wocJAEyWwWpKQoUxbhqEhIWYQYOdufxokXICcH6HiuwDJlF4gEJHIxdgn%2BjBMahRTHXhRHO%2BQsOVihmB2RB2tboL4vdcHkQYP1St7TMAiw37U9%2BHJsAU2l0FHC%2FEey7I86ZO5f0D5r3LKG50vnrTYNs6%2FzDxNRutX4lVrDFAiuLHIGjvuOSVEJbn6FbI04SAZcCe4N6Spx9mrde%2FDV16zxK14iZ%2F3xL%2BDfnaNMlO721Ce77UOyueMrN9oEt4%2Bnq5Sozbvq%2BJC4MibRlbnZi%2FA55pRsiklauuYwbC9XJT9fVEr%2B9cAGBzNc1d3TKWy%2FPbIyturOqk16LOon9Ybz5X2dyvfhced%2Bnxy8EM2m6YtTz34A&SigAlg=http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmldsig-more%23rsa-sha256";
  const matchingAlgo = "RSA-SHA256";
  const verifier = crypto.createVerify(matchingAlgo);
  verifier.update(urlString);
  console.log(verifier.verify(pemFile, signature, "base64"));
}

validate(pemFile1);
